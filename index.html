<!DOCTYPE html>
<html class="theme-dark">
	<head>
		<link type="text/css" rel="stylesheet" href="https://mwittrien.github.io/_res/css/discord.css"></link>
		<link type="text/css" rel="stylesheet" href="https://mwittrien.github.io/_res/css/main.css"></link>
		<style></style>
		<script>
			window.onload = function () {
				const getRects = node => {
					return Node.prototype.isPrototypeOf(node) && node.nodeType != Node.TEXT_NODE ? node.getBoundingClientRect() : {};
				};
				const createElement = html => {
					if (typeof html != "string" || !html.trim()) return null;
					let template = document.createElement("template");
					try {template.innerHTML = html.replace(/(?<!pre)>[\t\r\n]+<(?!pre)/g, "><");}
					catch (err) {template.innerHTML = html.replace(/>[\t\r\n]+<(?!pre)/g, "><");}
					if (template.content.childNodes.length == 1) return template.content.firstElementChild || template.content.firstChild;
					else {
						let wrapper = document.createElement("span");
						let nodes = Array.from(template.content.childNodes);
						while (nodes.length) wrapper.appendChild(nodes.shift());
						return wrapper;
					}
				};
				const formatClassName = (...classes) => {
					return [...new Set(classes.flat(10).filter(n => n).join(" ").split(" "))].join(" ").trim();
				};
				
				const createTooltip = (anker, text, config = {}) => {
					let itemLayerContainer = document.querySelector(".layer-items");
					if (!itemLayerContainer) return;
					let itemLayer = createElement(`<div class="layer-item layer-item-disabled">
						<div class="tooltip">
							<div class="tooltip-pointer"></div>
							<div class="tooltip-content"></div>
						</div>
					</div>`);
					itemLayerContainer.appendChild(itemLayer);
					
					let tooltip = itemLayer.firstElementChild;
					let tooltipContent = itemLayer.querySelector(".tooltip-content");
					let tooltipPointer = itemLayer.querySelector(".tooltip-pointer");
					
					if (config.id) tooltip.id = config.id.split(" ").join("");
					let type = config.type || "top";
					tooltip.classList.add(`tooltip-${type}`);
					tooltip.classList.add(config.color ? `tooltip-${config.color}` : "tooltip-primary");

					let mouseMove = e => {
						let parent = e.target.parentElement.querySelector(":hover");
						if (parent && anker != parent && !anker.contains(parent)) itemLayer.removeTooltip();
					};
					let mouseLeave = e => {itemLayer.removeTooltip();};
					document.addEventListener("mousemove", mouseMove);
					document.addEventListener("mouseleave", mouseLeave);
					
					let observer = new MutationObserver(changes => changes.forEach(change => {
						let nodes = Array.from(change.removedNodes);
						if (nodes.indexOf(itemLayer) > -1 || nodes.indexOf(anker) > -1 || nodes.some(n => n.contains(anker))) itemLayer.removeTooltip();
					}));
					observer.observe(document.body, {subtree: true, childList: true});
					
					(tooltip.setText = itemLayer.setText = newText => {
						if (config.html) tooltipContent.innerHTML = newText;
						else tooltipContent.innerText = newText;
					})(text);
					(tooltip.removeTooltip = itemLayer.removeTooltip = _ => {
						document.removeEventListener("mousemove", mouseMove);
						document.removeEventListener("mouseleave", mouseLeave);
						itemLayer.remove();
						observer.disconnect();
					});
					(tooltip.update = itemLayer.update = newText => {
						if (newText) tooltip.setText(newText);
						let left, top;
						const tRects = getRects(anker);
						const iRects = getRects(itemLayer);
						const aRects = getRects(document.querySelector(".app-mount"));
						const positionOffsets = {height: 10, width: 10};
						const offset = typeof config.offset == "number" ? config.offset : 0;
						switch (type) {
							case "top":
								top = tRects.top - iRects.height - positionOffsets.height + 2 - offset;
								left = tRects.left + (tRects.width - iRects.width) / 2;
								break;
							case "bottom":
								top = tRects.top + tRects.height + positionOffsets.height - 2 + offset;
								left = tRects.left + (tRects.width - iRects.width) / 2;
								break;
							case "left":
								top = tRects.top + (tRects.height - iRects.height) / 2;
								left = tRects.left - iRects.width - positionOffsets.width + 2 - offset;
								break;
							case "right":
								top = tRects.top + (tRects.height - iRects.height) / 2;
								left = tRects.left + tRects.width + positionOffsets.width - 2 + offset;
								break;
							}
							
						itemLayer.style.setProperty("top", `${top}px`, "important");
						itemLayer.style.setProperty("left", `${left}px`, "important");
						
						tooltipPointer.style.removeProperty("margin-left");
						tooltipPointer.style.removeProperty("margin-top");
						if (type == "top" || type == "bottom") {
							if (left < 0) {
								itemLayer.style.setProperty("left", "5px", "important");
								tooltipPointer.style.setProperty("margin-left", `${left - 10}px`, "important");
							}
							else {
								const rightMargin = aRects.width - (left + iRects.width);
								if (rightMargin < 0) {
									itemLayer.style.setProperty("left", `${aRects.width - iRects.width - 5}px`, "important");
									tooltipPointer.style.setProperty("margin-left", `${-1*rightMargin}px`, "important");
								}
							}
						}
						else if (type == "left" || type == "right") {
							if (top < 0) {
								itemLayer.style.setProperty("top", `5px`, "important");
								tooltipPointer.style.setProperty("margin-top", `${top - 10}px`, "important");
							}
							else {
								const bottomMargin = aRects.height - (top + iRects.height);
								if (bottomMargin < 0) {
									itemLayer.style.setProperty("top", `${aRects.height - iRects.height - 5}px`, "important");
									tooltipPointer.style.setProperty("margin-top", `${-1*bottomMargin}px`, "important");
								}
							}
						}
					})();
					
					return itemLayer;
				};
				const createSpinner = wrap => {
					return createElement(`${wrap ? '<div class="spinner-container">' : ''}<span class="spinner"><span class="spinner-inner"><span class="spinner-item"></span><span class="spinner-item"></span></span></span>${wrap ? '</div>' : ''}`);
				};
				const createLoadingList = (url, getHeader, getChildren) => {
					let header = createElement(`<div class="header">${typeof getHeader == "function" ? getHeader(0) : getHeader}</div>`);
					let list = createElement(`<div></div>`);
					list.appendChild(createSpinner(true));
					
					const xhttp = new XMLHttpRequest();
					xhttp.onload = function() {
						if (!document.contains(list)) return;
						try {
							while (list.childElementCount) list.firstElementChild.remove();
							list.classList.add("addon-list");
							let children = [getChildren(this.response)].flat(10).filter(n => n);
							for (let child of children) list.appendChild(child);
							header.innerText = typeof getHeader == "function" ? getHeader(children.length) : getHeader;
						}
						catch (err) {console.error("Error:", err);}
					};
					xhttp.open("GET", url);
					xhttp.send();
					
					return [header, list];
				};
				const createLibraryEntry = _ => {
					return createLoadingList("https://mwittrien.github.io/BetterDiscordAddons/Library/README.md", "Required Library", response => {
						let parsedResponse = response.trim().replace(/\r/g, "");
						return createAddonCard({
							name: (parsedResponse.split(" -")[0] || "").replace("# ", "").trim(),
							description: (parsedResponse.split("\n").pop() || "").trim(),
							buttons: [{
								text: "Download",
								svg: `<svg viewBox="0 0 24 24" class=""><path fill="currentColor" d="M 16.293,9.2929995 17.707,10.707 12,16.414 6.29297,10.707 7.70697,9.2929995 11,12.586 V 1.9999995 h 2 V 12.586 Z M 18,20 v -2 h 2 v 2 c 0,1.102 -0.896,2 -2,2 H 6 C 4.896,22 4,21.102 4,20 v -2 h 2 v 2 z" class=""></path></svg>`,
								onClick: _ => window.open("https://mwittrien.github.io/downloader/?library", "_target")
							}]
						});
					});
				};
				const createAddonList = type => {
					return createLoadingList(`https://mwittrien.github.io/BetterDiscordAddons/${type}/README.md`, amount => `${type} - ${amount}`, response => {
						return response.split("- [").splice(1).map(n => {
							let m = n.split("](");
							let l = m[1].split(") - ");
							return createAddonCard({
								name: (m[0] || "").trim(),
								description: (l[1] || "").trim(),
								icon: type == "Plugins" ? `<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24"><path fill="currentColor" d="m 11.470703,0.625 c -1.314284,0 -2.3808593,1.0666594 -2.3808592,2.3808594 V 4.4335938 H 5.2792969 c -1.0476168,0 -1.8945313,0.85855 -1.8945313,1.90625 v 3.6191406 h 1.4179688 c 1.41905,0 2.5722656,1.1512126 2.5722656,2.5703126 0,1.4191 -1.1532156,2.572266 -2.5722656,2.572265 H 3.375 v 3.619141 c 0,1.0477 0.8566801,1.904297 1.9042969,1.904297 h 3.6191406 v -1.427734 c 0,-1.4189 1.1532235,-2.572266 2.5722655,-2.572266 1.41905,0 2.570313,1.153366 2.570313,2.572266 V 20.625 h 3.61914 c 1.047626,0 1.90625,-0.856597 1.90625,-1.904297 v -3.810547 h 1.427735 c 1.314292,0 2.380859,-1.066559 2.380859,-2.380859 0,-1.3143 -1.066567,-2.38086 -2.380859,-2.380859 H 19.566406 V 6.3398438 c 0,-1.0477002 -0.858624,-1.90625 -1.90625,-1.90625 H 13.851562 V 3.0058594 c 0,-1.3142 -1.066568,-2.3808594 -2.380859,-2.3808594 z"/></svg>` : `<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M 15.234287,-2.5000473e-7 C 15.02721,-2.5000473e-7 14.820056,0.07834478 14.662059,0.23631857 L 8.2386669,6.6598939 17.339613,15.761099 23.763006,9.337523 c 0.315992,-0.3159477 0.315992,-0.8284847 0,-1.1444862 L 22.548244,6.9801939 C 22.273625,6.705567 21.84214,6.6642856 21.52097,6.8825414 l -2.552561,1.7343068 1.724492,-2.5702114 c 0.21539,-0.3210182 0.173831,-0.750065 -0.0996,-1.0233972 L 17.958711,2.3905307 C 17.715539,2.147353 17.344681,2.0830719 17.034946,2.2323338 L 16.579898,2.4530282 16.798634,1.9686723 C 16.936887,1.6620029 16.870459,1.3023022 16.632629,1.0644109 L 15.806514,0.23631857 C 15.648545,0.07834478 15.441364,-2.5000473e-7 15.234287,-2.5000473e-7 Z M 7.0434355,7.8551595 5.1841865,9.7144613 c -0.151739,0.1517432 -0.2363122,0.3576557 -0.2363122,0.5722437 0,0.214587 0.084519,0.420554 0.2363122,0.572243 l 1.7635523,1.763603 c 0.3397809,0.33979 0.505526,0.80928 0.4530942,1.287058 -0.052377,0.477455 -0.3168012,0.899444 -0.7226072,1.158157 -5.1821053,3.303397 -5.6651266,3.786402 -5.82382411,3.945158 -1.13920225,1.139181 -1.13920225,2.993361 0,4.13265 1.14033501,1.140368 2.99457091,1.138102 4.13253241,0 0.1588054,-0.158756 0.6419574,-0.642006 3.9450452,-5.823989 0.2580588,-0.404847 0.680468,-0.668188 1.1581247,-0.720676 0.479168,-0.05227 0.94805,0.112228 1.287022,0.451154 l 1.763552,1.763603 c 0.315939,0.315948 0.828515,0.315948 1.144454,0 l 1.859249,-1.859302 z M 2.9714457,19.885937 c 0.2926829,0 0.5852459,0.110645 0.808539,0.333971 0.4466403,0.446598 0.4466403,1.170471 0,1.617124 -0.4466402,0.446653 -1.1704915,0.446653 -1.6170779,0 -0.4466401,-0.446653 -0.4466401,-1.170526 0,-1.617124 0.2233201,-0.223326 0.5158561,-0.333971 0.8085389,-0.333971 z"/></svg>`,
								buttons: [{
									text: "Download",
									svg: `<svg viewBox="0 0 24 24" class=""><path fill="currentColor" d="M 16.293,9.2929995 17.707,10.707 12,16.414 6.29297,10.707 7.70697,9.2929995 11,12.586 V 1.9999995 h 2 V 12.586 Z M 18,20 v -2 h 2 v 2 c 0,1.102 -0.896,2 -2,2 H 6 C 4.896,22 4,21.102 4,20 v -2 h 2 v 2 z" class=""></path></svg>`,
									onClick: _ => window.open(`https://mwittrien.github.io/downloader/?${type.toLowerCase().slice(0, -1)}=${l[0].split("/").pop()}`, "_target")
								}]
							});
						});
					});
				};
				const createAddonCard = addon => {
					let card = createElement(`<div class="addon-card" role="button" tabindex="0">
						<div class="addon-header">
							<div class="addon-image-wrapper">
								<img class="addon-image" src="" alt="">
							</div>
							<div class="addon-icon-wrapper">
								<div class="addon-icon">${addon.icon}</div>
							</div>
						</div>
						<div class="addon-info">
							<div class="addon-title">
								<div class="addon-name">${addon.name}</div>
							</div>
							<div class="addon-description">${addon.description}</div>
							<div class="addon-controls">
								<div class="addon-links"></div>
								<div class="addon-buttons"></div>
							</div>
						</div>
					</div>`);
					let links = card.querySelector(".addon-links");
					let buttons = card.querySelector(".addon-buttons");
					if (addon.links) for (let link of addon.links) {
						let linkEle = createElement(`<div class="addon-link">${link.svg}</div>`);
						if (link.text) linkEle.addEventListener("mouseenter", _ => createTooltip(linkEle, link.text));
						if (link.url) linkEle.addEventListener("click", _ => window.open(addon.url, "_target"));
						links.appendChild(linkEle);
					}
					if (addon.buttons) for (let button of addon.buttons) {
						let buttonEle = createElement(`<div class="addon-button">${button.svg}</div>`);
						if (button.text) buttonEle.addEventListener("mouseenter", _ => createTooltip(buttonEle, button.text));
						if (button.onClick) buttonEle.addEventListener("click", button.onClick);
						buttons.appendChild(buttonEle);
					}
					return card;
				};
				
				const sidebar = document.querySelector(".sidebar-region .sidebar");
				const content = document.querySelector(".content-region .content");
				
				const sections = [
					{section: "Header", header: "My Stuff"},
					{section: "General", renderSection: _ => {}},
					{section: "Separator"},
					{section: "Plugins", renderSection: _ => [createAddonList("Plugins"), createElement(`<div class="divider"></div>`), createLibraryEntry()]},
					{section: "Themes", renderSection: _ => createAddonList("Themes")},
					{section: "Separator"},
					{section: "Generator", renderSection: _ => {}}
				];
				let selectedSection = sections.find(data => data.section != "Header" && data.section != "Separator").section;
				let items = [];
				
				for (const data of sections) {
					const item = createElement(data.section == "Header" ? `<div class="sidebar-header">${data.header}</div>` : data.section == "Separator" ? `<div class="sidebar-separator"></div>` : `<div class="${formatClassName("sidebar-item", selectedSection == data.section && "selected")}">${data.section}</div>`);
					if (data.renderSection) {
						items.push(item);
						item.addEventListener("click", _ => {
							if (selectedSection == data.section) return;
							while (content.childElementCount) content.firstElementChild.remove();
							let sectionElements = [data.renderSection()].flat(10).filter(n => n);
							for (let element of sectionElements) content.appendChild(element);
							for (let i of items) i.classList.remove("selected");
							item.classList.add("selected");
							selectedSection = data.section;
						});
					}
					sidebar.appendChild(item);
				}
			};
		</script>
	</head>
	<body>
		<div class="app-mount">
			<div class="app-container">
				<div class="app">
					<div class="bg"></div>
					<div class="layers">
						<div class="layer">
							<div class="sidebar-view">
								<div class="sidebar-region">
									<div class="scroller fade">
										<div class="sidebar"></div>
									</div>
								</div>
								<div class="content-region">
									<div class="scroller auto">
										<div class="content"></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="layer-items"></div>
		</div>
	</body>
</html>